{% assign lang = page.metafields['global'] %}

{% if lang.video.value %}
  {% assign video = lang.video.value %}
{% else %}
  {% assign video = lang.video %}
{% endif %}

{% if lang.videoBanner.value %}
  {% assign videoBanner = lang.videoBanner.value %}
{% else %}
  {% assign videoBanner = lang.videoBanner %}
{% endif %}

{% if lang.power.value %}
  {% assign power = lang.power.value %}
{% else %}
  {% assign power = lang.power %}
{% endif %}

{% if lang.system.value %}
  {% assign system = lang.system.value %}
{% else %}
  {% assign system = lang.system %}
{% endif %}

{% if lang.ultra.value %}
  {% assign ultra = lang.ultra.value %}
{% else %}
  {% assign ultra = lang.ultra %}
{% endif %}

{% if lang.flexibility.value %}
  {% assign flexibility = lang.flexibility.value %}
{% else %}
  {% assign flexibility = lang.flexibility %}
{% endif %}

{% if lang.extra.value %}
  {% assign extra = lang.extra.value %}
{% else %}
  {% assign extra = lang.extra %}
{% endif %}

{% if lang.dock.value %}
  {% assign dock = lang.dock.value %}
{% else %}
  {% assign dock = lang.dock %}
{% endif %}

{% if lang.whatbox.value %}
  {% assign whatbox = lang.whatbox.value %}
{% else %}
  {% assign whatbox = lang.whatbox %}
{% endif %}

{% if lang.cus_spces.value %}
  {% assign cus_spces = lang.cus_spces.value %}
{% else %}
  {% assign cus_spces = lang.cus_spces %}
{% endif %}

{% if lang.badges.value %}
  {% assign badges = lang.badges.value %}
{% else %}
  {% assign badges = lang.badges %}
{% endif %}

{% if lang.badges.value %}
  {% assign badges = lang.badges.value %}
{% else %}
  {% assign badges = lang.badges %}
{% endif %}

{% if lang.text_image.value %}
  {% assign text_image = lang.text_image.value %}
{% else %}
  {% assign text_image = lang.text_image %}
{% endif %}

{% if product.metafields['global']['custom_variants'].value %}
  {% assign custom_variants = product.metafields['global']['custom_variants'].value %}
{% else %}
  {% assign custom_variants = product.metafields['global']['custom_variants'] %}
{% endif %}

{% if page.metafields['global']['product_sku'].value %}
  {% assign product_sku = page.metafields['global']['product_sku'].value %}
{% else %}
  {% assign product_sku = page.metafields['global']['product_sku'] %}
{% endif %}

{{ 'X8-H30.scss.css' | asset_url | stylesheet_tag }}
{{ 'h30_new_reset.css' | asset_url | stylesheet_tag }}
<script src="{{ 'jquery.roundabout.min.js' | asset_url }}" defer></script>
<script src="{{ 'jquery.easing.1.3.js' | asset_url }}" defer></script>
<script src="{{ 'h30_new_reset.js' | asset_url }}" defer></script>

{% if localization.country.iso_code == 'US' %}
  {% style %}
  .sticky_banner{
    position: static;
    height: auto;
    padding-bottom: 0;
  }

  .product__H30-new .text_image{
    margin: 0 auto;
    max-width: 1200px;
  }

  .product__H30-new .flexibility{
    padding: 0;
  }

  .flexibility .contentBox{
    display: none;
  }

  @media (min-width: 769px){
    .product__H30-new .text_image{
      padding: 90px 0;
      width: 90%;
    }
    .product__H30-new .text_image .item .text .title{
      font-size: calc(32 / 1920 * 100vw);
    }

    .product__H30-new .text_image .item .text .desc{
      font-size: calc(18 / 1920 * 100vw);
    }

    .product__H30-new .power_new,
    .product__H30-new .system_new{
      position: relative;
      z-index: 1;
    }

    .product__H30-new .ultra .txt .tips{
      margin-top: 15vw;
      margin-bottom: 0;
    }

    .product__H30-new .banner .txt .title{
      font-size: calc(48 / 1920 * 100vw);
    }

    .product__H30-new .banner .txt .subtitle{
      font-size: calc(40 / 1920 * 100vw);
      font-weight: 600;
      line-height: 1.3;
    }

    .product__H30-new .banner .txt .desc{
      font-size: calc(18 / 1920 * 100vw);
    }
  }

  @media (max-width: 768px){
    .product__H30-new .power_new .txt{
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      transform: none;
    }

    .product__H30-new .system_new{
      position: relative;
      z-index: 1;
    }

    .product__H30-new .system_new .txt{
      width: 100%;
    }

    .product__H30-new .system_new .tips_mob{
      display: none;
    }

    .product__H30-new .ultra .txt .tips{
      margin-top: 10vw;
      margin-bottom: 0;
    }
  }
  {% endstyle %}
{% endif %}

<div class="product__H30-new">
  {% section 'page_top_bar' %}
  <!-- {% section 'whatInbox2'%} -->
  {% assign lang = page.metafields['global'] %}

  <section class="h30-content-new">
    <!-- <div class="badges">
      <div class="box">
        <div class="txt">
          {% for item in badges %}
            <p class="item">{{ item.txt }}</p>
          {% endfor %}
        </div>
        <div class="logos">
          {% for item in badges %}
            <a class="item" onClick="clickLogosIndex({{ forloop.index0 }})"><img src="{{ item.img }}" /></a>
          {% endfor %}
        </div>
      </div>
    </div> -->
  
    {% comment %} <div class="video">
      <div class="cover">
        <div class="coverBox">
          <img class="lazyload" data-src="{{ video.cover }}" />
          <a class="playVideo">
            <img class="lazyload" data-src="https://cdn.shopify.com/s/files/1/0521/9411/5753/files/banner_2_button.png?v=1634871701" alt="">
          </a>
        </div>
      </div>
      <div class="video_src">
        <div class="lazyframe" id="vimeoVideo" data-ratio="16:9"></div>
      </div>
      <a class="closeVideo">
        <img class="lazyload" data-src="https://cdn.shopify.com/s/files/1/0519/5458/1696/files/playing.png?v=1635304296" alt="">
      </a>
    </div> {% endcomment %}
  
    <div class="videoBanner banner banner_new" id="overview">
      <div class="bg">
        <video class="bg is-hidden-desktop-only" src="{{videoBanner.mob_bg}}" poster="{{videoBanner.mob_img}}" preload="auto" muted="muted" autoplay="autoplay" loop="loop" playsinline></video>
        <video class="bg lazyload is-hidden-mobile-only" data-src="{{ videoBanner.bg }}" poster="{{videoBanner.img}}" preload="auto" muted="muted" autoplay="autoplay" loop="loop" playsinline></video>
      </div>
      <div class="txt">
        <p class="txt_p">
          {{ videoBanner.text }}
          
        </p>
        <h3>{{ videoBanner.title }}</h3>
        <p class="txt_text">
          {{ videoBanner.txt }}
          
        </p>
        <div class="btn">
          
          <a class="watchvideo"><i class="iconfont">&#xe6d8;</i><span>{{ videoBanner.watch_video }}</span></a>
          {%- if videoBanner.buy_btn_text != blank -%}
            <a class="buy_btn" href="{{ videoBanner.buy_btn_href }}" target="{{ videoBanner.buy_btn_target }}">{{ videoBanner.buy_btn_text }}</a>
          {% endif %}
          {% if videoBanner.Addtocart_btn_text %}
            <div class="buy_btn" id="Addtocart_btn" >{{ videoBanner.Addtocart_btn_text }}</div>
          {% endif %}
        </div>
      </div>
    </div>
    {% section 'ActivityMedia' %}
    {% section 'ActivityVideo' %}
    <div class="H30_video" style="display: none;">
      <div class="box">
        <div class="lazyframe" id="H30_video_url" data-ratio="16:9"></div>
      </div>
      <a class="closeVideo"><i class="iconfont">&#xe723;</i></a>
    </div>
    
    <div id="sticky_banner" >
      <div class="sticky_banner" id="images">
        <div class="banner power_new">
          <div class="txt">
            <h3 class="title">{{ power.title }}</h3>
            <p class="desc">{{ power.desc }}</p>
          </div>
          <div class="img">
            <img alt="" class="lazyload pc_show" data-src="{{ power.img }}" />
            <img alt="" class="lazyload mob_show" data-src="{{ power.img_mob }}" />
          </div>
        </div>
        {% if localization.country.iso_code != 'US' %}
          <div class="txt is-hidden-desktop-only">
            <h3 class="title">{{ system.title }}</h3>
            <p class="desc">{{ system.desc }}</p>
            <p class="tips is-hidden-mobile-only">{{ system.tips }}</p>
          </div>
        {% endif %}
        <div class="banner system_new">
          <div class="txt is-hidden-mobile-only">
            <h3 class="title">{{ system.title }}</h3>
            {% if system.desc != blank %}
              <p class="desc">{{ system.desc }}</p>
            {% endif %}
            {% if system.subtitle != blank %}
              <p class="subtitle">{{ system.subtitle }}</p>
            {% endif %}
          </div>
          {% if localization.country.iso_code == 'US' %}
            <div class="txt is-hidden-desktop-only">
              <h3 class="title">{{ system.title }}</h3>
              <p class="subtitle">{{ system.subtitle }}</p>
              <p class="tips is-hidden-mobile-only">{{ system.tips }}</p>
            </div>
          {% endif %}
          <div class="img">
            <span class="txt1">{{ system.txt1 }}</span>
            <span class="txt2">{{ system.txt2 }}</span>
            <img alt="" class="lazyload pc_show" data-src="{{ system.img }}" />
            <img alt="" class="lazyload mob_show" data-src="{{ system.img_mob }}" />
          </div>
          <p class="tips mob_show tips_mob">{{ system.tips }}</p>
          <p class="tips_text is-hidden-mobile-only">{{ system.tips }}</p>
        </div>
      </div>
    </div>
    <div class="banner ultra" >
      <div class="img">
        <img alt="" class="lazyload is-hidden-mobile-only" data-src="{{ ultra.img }}" />
        <img alt="" class="lazyload is-hidden-desktop-only" data-src="{{ ultra.mob_img }}" />
      </div>
      <div class="txt">
        {% if localization.country.iso_code == 'US' %}
          <h3 class="title">{{ ultra.title }}</h3>
          <p class="desc">{{ ultra.desc }}</p>
          <p class="tips">
            <img alt="" class="lazyload" data-src="{{ ultra.icon }}" />
            <span>{{ ultra.tips }}</span>
          </p>
        {% else %}
          <p class="tips">
            <img alt="" class="lazyload" data-src="{{ ultra.icon }}" />
            <span>{{ ultra.tips }}</span>
          </p>
          <h3 class="title">{{ ultra.title }}</h3>
          <p class="desc">{{ ultra.desc }}</p>
        {% endif %}
      </div>
    </div>
    <div class="flexibility" id="feature">
      <div class="contentBox">
        <div class="img">
          {% for item in flexibility.list %}
            <img alt="" class="lazyload" data-src="{{ item }}" />
          {% endfor %}
        </div>
        <div class="txt">
          <h3 class="title">{{ flexibility.title }}</h3>
        </div>
      </div>
    </div>
  
    <div class="text_image">
      {% for item in text_image %}
        <div class="item">
          {% if item.video %}
            <div class="video">
              <video  src="{{ item.video }}" playsinline muted="muted" autoplay="autoplay" loop="loop"></video>
            </div>
          {% else %}
            <div class="image">
              <img class="lazyload" alt="" data-src="{{ item.img }}" />
            </div>
          {% endif %}
          <div class="text {% if item.iconlist %}text_center{% endif %}">
            <h3 class="title">{{ item.title }}</h3>
            <p class="desc">{{ item.desc }}</p>
            <p class="tips">{{ item.tips }}</p>
            {% if item.iconlist %}
              <div class="iconlist">
                {% for i in item.iconlist %}
                  <div class="iconitem">
                    <img class="lazyload" alt="" data-src="{{ i.icon }}" />
                    <p>{{ i.txt }}</p>
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  
    <div class="extra">
      <div class="contentBox">
        <div class="txt">
          <p class="tips">{{ extra.tips1 }}</p>
          <h3 class="title">{{ extra.title }}</h3>
          <p class="tips">{{ extra.tips2 }}</p>
          <p class="desc">{{ extra.desc }}</p>
        </div>
        <div class="img">
          <div class="img1">
            <img class="lazyload" alt="" data-src="{{ extra.img1 }}" />
          </div>
          <div class="img2">
            <img class="lazyload" alt="" data-src="{{ extra.img2 }}" />
            <img class="lazyload" alt="" data-src="{{ extra.img3 }}" />
          </div>
        </div>
      </div>
    </div>
  
    <div class="banner dock">
      <div class="img">
        <img alt="" class="lazyload is-hidden-mobile-only" data-src="{{ dock.img }}" />
        <img alt="" class="lazyload is-hidden-desktop-only" data-src="{{ dock.mob_img }}" />
      </div>
      <div class="txt">
        <h3 class="title">{{ dock.title }}</h3>
        <p class="desc">{{ dock.desc }}</p>
      </div>
    </div>
  
    <div class="whatsbox">
      <div class="bg">
        <img alt="" class="lazyload" data-src="{{ whatbox.bg }}" />
      </div>
      <div class="txt">
        <h3>{{ whatbox.title }}</h3>
        <p>{{ whatbox.desc }}</p>
      </div>
    </div>
    <div class="proSpces" id="specs">
      <h3 class="proSpcesTitle"><span>{{ cus_spces.title }}</span></h3>
      <ul>
        {% for item in cus_spces.list %}
          <li>
            <h3 class="title"><span>{{ item.key }}</span><i></i></h3>
            <div class="txt">
              <div class="txtBox">{{ item.value }}</div>
            </div>
          </li>
        {% endfor %}
      </ul>
    </div>
  </section>
</div>
{% if localization.country.iso_code != 'US' %}
<script>
  $(document).ready(function(){
    if ($(window).width()>768) {
      $('#sticky_banner').height($(window).height()*2)
      window.addEventListener('scroll',function(){
        let domTop = document.getElementById('sticky_banner').getBoundingClientRect().top
        let h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
        if ( domTop <= 0 ) {
          $('.power_new').css({ transform :`translateY(${-(Math.abs(domTop)/(h-200))*100}%)`})
        }
      })
    }
  })
</script>
{% endif %}


<script>

  let logosIndex = 0;
  let len;
  let logosIndexInt;
  let player;
  $(document).ready(function(){
    $('#Addtocart_btn').on('click',function(){
      let variants = [];
      {% assign product = all_products[product_sku] %}
      variants.push({ id: {{ product.variants[0].id }} , quantity: 1 })
      Shopify.theme.addItemsToCart(variants, {
        onError: err => $.dialog({ title: err.message, content: err.description, type: 'red' })
      })
    })
    // spces
    $('.proSpces .txt').each((i, ele) => {
      const h = ele.offsetHeight;
      ele.style.maxHeight = `${h}px`;
    });
    $('.proSpces .txt').addClass('hideTxt');
    $(document).on('click', '.proSpces .title', function() {
      const $dom = $(this).parents('li');
      if ($($('.txt', $dom)).hasClass('showTxt')) {
        $($('.txt', $dom)).removeClass('showTxt');
        $(this).removeClass('showTxt');
        $($('.txt', $dom)).addClass('hideTxt');
      } else {
        $('.proSpces .title').removeClass('showTxt');
        $('.proSpces .txt').removeClass('showTxt');
        $('.proSpces .txt').addClass('hideTxt');
        $($('.txt', $dom)).addClass('showTxt');
        $(this).addClass('showTxt');
        $($('.txt', $dom)).removeClass('hideTxt');
      }
    });

    // custom_variants
    const custom_variants = JSON.parse('{{ custom_variants | json }}');
    if (custom_variants) {
      let sku = "";
      {%- for variant in product.variants -%}
        {% if forloop.first == true %}
          sku = "{{ variant.sku }}"
        {% endif %}
      {% endfor %}
      const dom = custom_variants.sku.map((v, i) => {
        const act = sku === v ? 'current' : '';
        return `<li class="color ${act}" data-sku="${v}">
          <a href="/products/${v}">
            <div class="dot" style="background: ${custom_variants.background[i]}"></div>
          </a>
          <span class="txt"> ${custom_variants.color_txt[i]}</span>
        </li>`;
      }).join('');
      if (custom_variants.sku.indexOf(sku) > -1) {
        $('.custom_variants').html(`<ul class="options">${dom}</ul>`);
        $('.custom_variants').removeClass('swap--visible');
      }
    }

    // 奖项
    len = $('.h30-content-new .badges .txt .item').length - 1;
    setLogosIndex(0);
    logosIndexInt = setInterval(() => {
      if (logosIndex < len) {
        logosIndex += 1;
      } else {
        logosIndex = 0;
      }
      setLogosIndex(logosIndex);
    }, 3000);

  })

  $('.watchvideo').on('click', function() {
    if(!player) {
      const tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    } else {
      $('.H30_video').show();
      player.playVideo();
      dataLayer.push({
        "event": "uaEvent", // Trigger
        "eventCategory": 'h30_landing_page',
        "eventAction": "1st_banner",
        "eventLabel": "watch_the_video",
    })
    }
  })
  $('.buy_btn').on('click',function(){
    dataLayer.push({
      "event": "uaEvent", // Trigger
      "eventCategory": 'h30_landing_page',
      "eventAction": "1st_banner",
      "eventLabel": "buy",
  })
  })
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('H30_video_url', {
      height: '100%',
      width: '100%',
      videoId: '{{ videoBanner.ytb_id }}',
      playlist: ['{{ videoBanner.ytb_id }}']
    });
    $('.H30_video').show();
    window.setTimeout(function() {
      player.playVideo();
    } , 2000);
  }
  $(document).on('click', '.closeVideo', function() {
    $('.H30_video').hide()
    player.pauseVideo();
  })

  function clickLogosIndex(num) {
    logosIndex = num;
    setLogosIndex(logosIndex);
    if(logosIndexInt) clearInterval(logosIndexInt);
    logosIndexInt = setInterval(() => {
      if (logosIndex < len) {
        logosIndex += 1;
      } else {
        logosIndex = 0;
      }
      setLogosIndex(logosIndex);
    }, 3000);
  }

  function setLogosIndex(num) {
    $('.h30-content-new .badges .txt .item').removeClass('active');
    $('.h30-content-new .badges .logos .item').removeClass('active');
    $('.h30-content-new .badges .txt .item').eq(num).addClass('active');
    $('.h30-content-new .badges .logos .item').eq(num).addClass('active');
  }
</script>

